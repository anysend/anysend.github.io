<!DOCTYPE html>
<html>
  <head>
    <title>Any Send</title>
    <link href='http://fonts.googleapis.com/css?family=Lato:100,300,400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="main.css" type="text/css">
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script type="text/javascript" src="/js/async.min.js"></script>
    <script>
    var A_URL = 'https://play.google.com/store/apps/details?id=adylitica.android.anysend';

    $(function() { $('body').addClass('loaded'); });

    function CurveAnimator(points){
      var from = points[0],
        to = points[1],
        c1 = points[2],
        c2 = points[3];

      this.path = document.createElementNS('http://www.w3.org/2000/svg','path');
      if (!c1) c1 = from;
      if (!c2) c2 = to;
      this.path.setAttribute('d','M'+from.join(',')+'C'+c1.join(',')+' '+c2.join(',')+' '+to.join(','));
      this.updatePath();
      CurveAnimator.lastCreated = this;
    }
    CurveAnimator.prototype.animate = function(duration,callback,delay){
      var curveAnim = this;
      // TODO: Use requestAnimationFrame if a delay isn't passed
      if (!delay) delay = 1/40;
      clearInterval(curveAnim.animTimer);
      var startTime = new Date;
      curveAnim.animTimer = setInterval(function(){
        var elapsed = ((new Date)-startTime)/1000;
        var percent = elapsed/duration;
        if (percent>=1){
          percent = 1;
          clearInterval(curveAnim.animTimer);
        }
        var p1 = curveAnim.pointAt(percent-0.01),
            p2 = curveAnim.pointAt(percent+0.01);
        callback(curveAnim.pointAt(percent),Math.atan2(p2.y-p1.y,p2.x-p1.x)*180/Math.PI);
      },delay*1000);
    };
    CurveAnimator.prototype.stop = function(){
      clearInterval(this.animTimer);
    };
    CurveAnimator.prototype.pointAt = function(percent){
      return this.path.getPointAtLength(this.len*percent);
    };
    CurveAnimator.prototype.updatePath = function(){
      this.len = this.path.getTotalLength();
    };
    CurveAnimator.prototype.setStart = function(x,y){
      var M = this.path.pathSegList.getItem(0);
      M.x = x; M.y = y;
      this.updatePath();
      return this;
    };
    CurveAnimator.prototype.setEnd = function(x,y){
      var C = this.path.pathSegList.getItem(1);
      C.x = x; C.y = y;
      this.updatePath();
      return this;
    };
    CurveAnimator.prototype.setStartDirection = function(x,y){
      var C = this.path.pathSegList.getItem(1);
      C.x1 = x; C.y1 = y;
      this.updatePath();
      return this;
    };
    CurveAnimator.prototype.setEndDirection = function(x,y){
      var C = this.path.pathSegList.getItem(1);
      C.x2 = x; C.y2 = y;
      this.updatePath();
      return this;
    };

    $(function() {
      $('#downloads li').click(function() {
        $('#downloads .selected').removeClass('selected');
        $('#dl').prop('class', $(this).prop('class'));
        $(this).addClass('selected');
      });

      $('#quick_download button').click(function() {
         var destination = $('#downloads').offset().top;
         $("html:not(:animated),body:not(:animated)").animate({ scrollTop: destination-20}, 200);
      });

      $('#dl button.android').click(function() { location.href = A_URL; });

      var arcs = [];

      arcs.push(
        {
          time: 0.9,
          points: [
            [76,322], [314,199],
            [53,0], [250,-50]
          ],
          name: 'arc1',
          file: 'folder',
          scale: 'smaller'
        },

        {
          time: 0.9,
          points: [
            [183,357], [842,390],
            [186,70], [850,10]
          ],
          name: 'arc2',
          file: 'music',
          scale: 'bigger'
        },

        {
          time: 0.9,
          points: [
          [834,392], [-60,476],
          [803,228], [5,110]
          ],
          name: 'arc3',
          file: 'photo',
          scale: 'smaller'
        }
      );

      var flyingIteration = 0;

      var flying = function() {
        async.forEachSeries(arcs, function(arc, go_on) {
          flyingIteration++;

          var curve = new CurveAnimator(arc.points);

          var o = $('#movement .' + arc.name)[0];

          $('#movement .moving').removeClass('moving');

          $(o).removeClass('vanish smaller bigger').addClass('moving ' + arc.scale);

          $(o).find('.file').css('background-image', 'url(/images/' + arc.file + '.png)');

          curve.animate(arc.time, function(point,angle) {
            var transform = 'translateX(' + point.x + 'px) translateY(' + point.y + 'px)';

            o.style.webkitTransform = transform;
          });

          setTimeout(function() { $(o).addClass('vanish'); }, 1000);

          var buffer = 1000;

          if (flyingIteration === 1) buffer = 2600;
          else if (flyingIteration === 2) buffer = 2000;
          else if (flyingIteration > 2) 
            buffer = 700 * (1 + Math.sin(((0.5*Math.PI/20)*flyingIteration) +
              0.5*Math.PI));

          setTimeout(go_on, arc.time * 200 + buffer);
        },
        function() {
          console.log('finished round');

          var shuffle = function(array) {
              var tmp, current, top = array.length;

              if(top) while(--top) {
                  current = Math.floor(Math.random() * (top + 1));
                  tmp = array[current];
                  array[current] = array[top];
                  array[top] = tmp;
              }

              return array;
          }

          arcs = shuffle(arcs);

          var images = shuffle(['folder', 'photo', 'music', 'note']);

          arcs.forEach(function(arc, i) {
            var original = arc.points.slice(0);
            arc.points[0] = original[1]
            arc.points[1] = original[0];
            arc.points[2] = original[3];
            arc.points[3] = original[2];
            arc.scale = arc.scale === 'bigger' ? 'smaller' : 'bigger';
            arc.file = images[i];
          });

          flying();
        });
      };

      $(function() {
        setTimeout(flying, 1000);
      })

      $('#movement').addClass('running');


    });
    </script>
  </head>
  <body>
    <div id="movement">
      <span class="arc1 arc"><span class="file"></span></span>
      <span class="arc2 arc"><span class="file"></span></span>
      <span class="arc3 arc"><span class="file"></span></span>
    </div>
    <span id="logo"></span>
    <div id="main">
      <div id="arcs"></div>
      <div id="big_logo"></div>
      <div id="quick_sell" class="section">
        <h2>Quick &amp; easy filesharing over wifi</h2>

        <p>
Stop using email to send files to people on your wifi. AnySend is <strong>copy &amp; paste</strong> for your home or office network.
          <br><br>
          AnySend works <strong>between devices</strong>. Send something from your Mac to your phone? No problem.
        </p>

        <div id="quick_download">
          <button>download</button>
          <label>available for multiple devices</label>
        </div>
      </div> <!-- end #quick_sell -->

      <div id="simplicity" class="section">
        <h2>So simple it&#8217;s easy</h2>

        <ol class="well">
          <li class="copy">Copy a file.</li>
          <li class="who">Paste it to someone.</li>
          <li class="goes">Done.</li>
        </ol>

        <h4>
          Requires AnySend Apps designed for the specific devices. Check out the screenshots.
        </h4>
      </div> <!-- end #simplicity -->

      <div id="downloads" class="section">
        <h2>Get it for your:</h2>

        <ol class="well">
          <li class="windows"><label></label></li>
          <li class="mac selected"><label></label></li>
          <li class="android"><label></label></li>
          <li class="iphone"><label></label></li>
          <li class="ipad"><label></label></li>
        </ol>

        <div id="dl" class="mac">
          <button class="mac">mac</button>
          <button class="android">android</button>
          <form class="windows well">
            <input type="email" placeholder="add your email">
            <button>go</button>
          </form>
          <form class="ipad well">
            <input type="email" placeholder="add your email">
            <button>go</button>
          </form>
          <form class="iphone well">
            <input type="email" placeholder="add your email">
            <button>go</button>
          </form>
        </div>
      </div> <!-- end #downloads -->
    </div> <!-- end #main -->

    <footer>
      <ol id="sharing">
        <li class="twitter"></li>
        <li class="facebook"></li>
        <li class="pinterest"></li>
        <li class="linkedin"></li>
      </ol>
    </footer>
  </body>
</html>
